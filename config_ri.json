{
  "seed": 1337,
  "device": "cuda:0",
  "data": {
    "root": "./datasets/fastmri_knee",
    "representation": "ri",
    "crop_size": 192,
    "stages": {
      "train": {
        "split": "train",
        "paired": true,
        "augment": true,
        "batch_size": 2,
        "shuffle": true,
        "drop_last": true
      },
      "val": {
        "split": "val",
        "paired": true,
        "augment": false,
        "batch_size": 4,
        "shuffle": false
      },
      "test": {
        "split": "test",
        "paired": true,
        "augment": false,
        "batch_size": 1,
        "shuffle": false
      }
    }
  },
  "model": {
    "cdlnet": {
      "K": 30,
      "M": 169,
      "P": 7,
      "s": 2,
      "C": 1,
      "adaptive": true,
      "t0": 0.0,
      "representation": "ri"
    },
    "encoder": {
      "class": "SharedEncoder",
      "checkpoint": null
    },
    "decoder_a": {
      "class": "DomainADecoder",
      "checkpoint": null
    },
    "decoder_b": {
      "class": "DomainBDecoder",
      "checkpoint": null
    }
  },
  "optimizer": {
    "type": "adamw",
    "learning_rate": 0.0003,
    "weight_decay": 0.01,
    "betas": [0.9, 0.999]
  },
  "scheduler": {
    "type": "cosine",
    "t_max": 50,
    "eta_min": 1e-6
  },
  "trainer": {
    "loss_weights": {
      "content": 1.0,
      "recon": 0.5,
      "cross": 1.0,
      "edge": 0.05
    },
    "noise": {
      "enabled": true,
      "sigma_a": 0.01,
      "sigma_b": 0.01
    },
    "augmentation": {
      "enable_jitter": true,
      "brightness": 0.05,
      "contrast": 0.1
    },
    "edge_loss": {
      "enabled": true,
      "weight": 0.02
    },
    "anti_collapse": {
      "variance_threshold": 1e-5,
      "patience": 2,
      "adjustment_factor": 0.2,
      "max_alpha": 8.0,
      "min_beta": 0.0005
    },
    "logging": {
      "use_wandb": true,
      "image_interval": 200,
      "project": "contrast2contrast",
      "entity": null
    },
    "noise_estimation": {
      "enabled": true,
      "method": "wvlt_c"
    },
    "epochs": 5,
    "encoder_output_index": -1,
    "scheduler_step": "epoch",
    "grad_clip_norm": 1.0,
    "input_keys": {
      "domain_a": "noisy_pd",
      "domain_b": "noisy_pdfs"
    }
  }
}
