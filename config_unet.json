{
  "seed": 1337,
  "device": "cuda:0",
  "data": {
    "root": "./datasets/fastmri_knee",
    "representation": "complex",
    "crop_size": 256,
    "stages": {
      "train": {
        "split": "train",
        "paired": true,
        "augment": true,
        "batch_size": 4,
        "shuffle": true,
        "drop_last": true
      },
      "val": {
        "split": "val",
        "paired": true,
        "augment": false,
        "batch_size": 4,
        "shuffle": false
      }
    }
  },
  "model": {
    "cdlnet": {
      "M": 256
    },
    "encoder": {
      "class": "UNetEncoder",
      "checkpoint": null,
      "kwargs": {
        "features": [64, 128, 256],
        "latent_channels": 256
      }
    },
    "decoder_a": {
      "class": "UNetADecoder",
      "checkpoint": null,
      "kwargs": {
        "features": [256, 128, 64],
        "latent_channels": 256,
        "identity_mapping": true
      }
    },
    "decoder_b": {
      "class": "UNetBDecoder",
      "checkpoint": null,
      "kwargs": {
        "features": [256, 128, 64],
        "latent_channels": 256,
        "identity_mapping": true
      }
    }
  },
  "optimizer": {
    "type": "adamw",
    "learning_rate": 0.0003,
    "weight_decay": 0.01,
    "betas": [
      0.9,
      0.999
    ]
  },
  "scheduler": {
    "type": "cosine",
    "t_max": 50,
    "eta_min": 1e-6
  },
  "trainer": {
    "loss_weights": {
      "content": 1.0,
      "recon": 1.5,
      "cross": 0,
      "edge": 0
    },
    "noise": {
      "enabled": true,
      "sigma_a": 0.25,
      "sigma_b": 0.25
    },
    "augmentation": {
      "enable_jitter": false,
      "brightness": 0.05,
      "contrast": 0.1
    },
    "edge_loss": {
      "enabled": true,
      "weight": 0.02
    },
    "anti_collapse": {
      "variance_threshold": 1e-5,
      "patience": 2,
      "adjustment_factor": 0.2,
      "max_alpha": 8.0,
      "min_beta": 0.0005
    },
    "logging": {
      "use_wandb": true,
      "image_interval": 200,
      "project": "contrast2contrast-unet",
      "entity": null
    },
    "noise_estimation": {
      "enabled": true,
      "method": "auto"
    },
    "epochs": 5,
    "encoder_output_index": -1,
    "input_representation": "complex",
    "scheduler_step": "epoch",
    "grad_clip_norm": 1.0,
    "input_keys": {
      "domain_a": "noisy_pd",
      "domain_b": "noisy_pdfs"
    }
  }
}
