{
  "seed": 1337,
  "device": "cuda:0",
  "data": {
    "root": "./datasets/fastmri_knee",
    "representation": "complex",
    "crop_size": 256,
    "stages": {
      "train": {"split": "train", "paired": true, "augment": true, "batch_size": 4, "shuffle": true, "drop_last": true},
      "val": {"split": "val", "paired": true, "augment": false, "batch_size": 4, "shuffle": false}
    }
  },
  "model": {
    "cdlnet": {"M": 256},
    "encoder": {"class": "UNetEncoder", "checkpoint": "./runs/progressive_stage1/best.pt", "state_key": "encoder", "kwargs": {"features": [64, 128, 256], "latent_channels": 256}},
    "decoder_a": {"class": "UNetADecoder", "checkpoint": "./runs/progressive_stage1/best.pt", "state_key": "decoder_a", "kwargs": {"features": [256, 128, 64], "latent_channels": 256, "identity_mapping": false}},
    "decoder_b": {"class": "UNetBDecoder", "checkpoint": "./runs/progressive_stage1/best.pt", "state_key": "decoder_b", "kwargs": {"features": [256, 128, 64], "latent_channels": 256, "identity_mapping": false}}
  },
  "optimizer": {"type": "adamw", "learning_rate": 0.0001, "weight_decay": 0.01, "betas": [0.9, 0.999]},
  "scheduler": {"type": "cosine", "t_max": 50, "eta_min": 1e-6},
  "trainer": {
    "loss_weights": {
      "content": 0.5,
      "recon": 0.1,
      "cross": 1.0,
      "edge": 0.05
    },
    "noise": {"enabled": true, "sigma_a": 0.01, "sigma_b": 0.01},
    "augmentation": {"enable_jitter": false, "brightness": 0.05, "contrast": 0.1},
    "edge_loss": {"enabled": true, "weight": 0.05},
    "anti_collapse": {"variance_threshold": 1e-5, "patience": 2, "adjustment_factor": 0.2, "max_alpha": 8.0, "min_beta": 0.0005},
    "logging": {"use_wandb": true, "image_interval": 200, "project": "c2c-progressive-stage2", "entity": null},
    "noise_estimation": {"enabled": true, "method": "auto"},
    "epochs": 40,
    "encoder_output_index": -1,
    "input_representation": "complex",
    "scheduler_step": "epoch",
    "grad_clip_norm": 1.0,
    "input_keys": {"domain_a": "noisy_pd", "domain_b": "noisy_pdfs"},
    "cross_domain_strategy": "no_skip",
    "mixed_skip_alpha": 0.5,
    "_comment": "Stage 2: Load stage1 weights, focus on denoising with weak recon (0.1), strong cross (1.0), lower LR"
  }
}
